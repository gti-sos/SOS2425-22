import{t as I,a as m,b as j}from"../chunks/CVH-v-h3.js";import"../chunks/WMW66P1P.js";import{w as Ut,t as tt,x as g,y as Vt,$ as Kt,v as r,z as s,A as a,g as t,B as l,C as i,D as Qt,E as D,F as Rt}from"../chunks/5T3b_xH8.js";import{s as k}from"../chunks/Y3llCd5_.js";import{s as Xt,i as At,a as Zt}from"../chunks/DKPZ7Wbn.js";import{h as te}from"../chunks/Dudt7YSU.js";import{A as ee,T as re,r as v,b as p,B as et}from"../chunks/htKHjpT0.js";import{i as se}from"../chunks/ninUAtNp.js";import{s as ae,g as rt}from"../chunks/Cv4eHxYS.js";import{o as ie}from"../chunks/Be9tLMDm.js";const oe=()=>{const _=ae;return{page:{subscribe:_.page.subscribe},navigating:{subscribe:_.navigating.subscribe},updated:_.updated}},ne={subscribe(_){return oe().page.subscribe(_)}};var le=I("<p>Cargando datos...</p>"),de=I('<thead><tr><th class="svelte-xebk95">Campo</th><th class="svelte-xebk95">Valor Actual</th></tr></thead> <tbody><tr><td class="svelte-xebk95">Province</td><td class="svelte-xebk95"> </td></tr><tr><td class="svelte-xebk95">Creation Year</td><td class="svelte-xebk95"><input type="number" class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">ID</td><td class="svelte-xebk95"> </td></tr><tr><td class="svelte-xebk95">Portal ID</td><td class="svelte-xebk95"><input type="number" class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Postal Code</td><td class="svelte-xebk95"><input type="number" class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Latitude</td><td class="svelte-xebk95"><input type="number" step="0.000001" class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Length</td><td class="svelte-xebk95"><input type="number" step="0.000001" class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Title</td><td class="svelte-xebk95"><input class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Equipment Type</td><td class="svelte-xebk95"><input class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Public Titularity</td><td class="svelte-xebk95"><input class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Street Address</td><td class="svelte-xebk95"><input class="svelte-xebk95"></td></tr><tr><td class="svelte-xebk95">Year</td><td class="svelte-xebk95"> </td></tr><tr><td class="svelte-xebk95">Number of Workers</td><td class="svelte-xebk95"><input type="number" class="svelte-xebk95"></td></tr></tbody>',1),ce=I('<!> <div class="actions svelte-xebk95"><!> <!> <!></div>',1),ue=I("<h2> </h2> <!> <!>",1);function ge(_,st){Ut(st,!1);const[jt,Dt]=Zt(),L=()=>Xt(ne,"$page",jt);let q=`/api/v2/ministry-of-justice-in-zaragoza/${L().params.province}/${L().params.year}/${L().params.id}`,o=l({}),c=l(!1),y=l({text:"",type:""}),h=l(),w=l(),E=l(),T=l(),M=l(),P=l(),z=l(),C=l(),N=l(),A=l();function f(e,d="info",b=5e3){i(y,{text:e,type:d}),b>0&&setTimeout(()=>Qt(y,t(y).text=""),b)}function S(e){return e.includes("404")?"No se encontró el ministerio":e.includes("400")?"Datos inválidos":e.includes("500")?"Error del servidor":"Error inesperado"}async function It(){i(c,!0);try{const e=await fetch(q,{method:"GET"});if(!e.ok)throw new Error(`HTTP ${e.status}`);i(o,await e.json()),i(h,t(o).creation_year),i(w,t(o).portalId),i(E,t(o).latitude),i(T,t(o).postal_code),i(M,t(o).length),i(P,t(o).title),i(z,t(o).equipment_type),i(C,t(o).public_titularity),i(N,t(o).street_address),i(A,t(o).num_workers)}catch(e){console.error("Error:",e),f(S(e.message),"error")}finally{i(c,!1)}}async function Lt(){i(c,!0),f("Actualizando ministerio...","info");try{const e={province:t(o).province,year:t(o).year,id:t(o).id,creation_year:Number(t(h)),portalId:Number(t(w)),postal_code:Number(t(T)),latitude:Number(t(E)),length:Number(t(M)),title:t(P),equipment_type:t(z),public_titularity:t(C),street_address:t(N),num_workers:Number(t(A))},d=await fetch(q,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(d.ok)f("Ministerio actualizado correctamente","success"),setTimeout(()=>rt("/ministry-of-justice-in-zaragoza"),1500);else{const b=await d.json();throw new Error(b.message||`HTTP ${d.status}`)}}catch(e){console.error("Error:",e),f("Error al actualizar: "+S(e.message),"error")}finally{i(c,!1)}}async function qt(){i(c,!0),f("Eliminando ministerio...","info");try{const e=await fetch(q,{method:"DELETE"});if(e.ok)f("Ministerio eliminado correctamente","success"),setTimeout(()=>rt("/ministry-of-justice-in-zaragoza"),1500);else throw new Error(`HTTP ${e.status}`)}catch(e){console.error("Error:",e),f("Error al eliminar: "+S(e.message),"error")}finally{i(c,!1)}}ie(async()=>{await It()}),se();var at=ue();te(e=>{Kt.title="Editar"});var B=tt(at),St=s(B);a(B);var it=r(B,2);{var Bt=e=>{const d=Rt(()=>t(y).type==="success"?"success":t(y).type==="error"?"danger":"info");ee(e,{get color(){return t(d)},children:(b,G)=>{D();var $=j();g(()=>k($,t(y).text)),m(b,$)},$$slots:{default:!0}})};At(it,e=>{t(y).text&&e(Bt)})}var Gt=r(it,2);{var Ht=e=>{var d=le();m(e,d)},Yt=e=>{var d=ce(),b=tt(d);re(b,{children:(x,H)=>{var u=de(),nt=r(tt(u),2),Y=s(nt),lt=r(s(Y)),Ft=s(lt);a(lt),a(Y);var W=r(Y),dt=r(s(W)),ct=s(dt);v(ct),a(dt),a(W);var F=r(W),ut=r(s(F)),Jt=s(ut);a(ut),a(F);var J=r(F),vt=r(s(J)),pt=s(vt);v(pt),a(vt),a(J);var O=r(J),bt=r(s(O)),mt=s(bt);v(mt),a(bt),a(O);var U=r(O),_t=r(s(U)),yt=s(_t);v(yt),a(_t),a(U);var V=r(U),ft=r(s(V)),xt=s(ft);v(xt),a(ft),a(V);var K=r(V),kt=r(s(K)),$t=s(kt);v($t),a(kt),a(K);var Q=r(K),gt=r(s(Q)),ht=s(gt);v(ht),a(gt),a(Q);var R=r(Q),wt=r(s(R)),Et=s(wt);v(Et),a(wt),a(R);var X=r(R),Tt=r(s(X)),Mt=s(Tt);v(Mt),a(Tt),a(X);var Z=r(X),Pt=r(s(Z)),Ot=s(Pt);a(Pt),a(Z);var zt=r(Z),Ct=r(s(zt)),Nt=s(Ct);v(Nt),a(Ct),a(zt),a(nt),g(()=>{k(Ft,`${t(o).province??""} (no editable)`),k(Jt,`${t(o).id??""} (no editable)`),k(Ot,`${t(o).year??""} (no editable)`)}),p(ct,()=>t(h),n=>i(h,n)),p(pt,()=>t(w),n=>i(w,n)),p(mt,()=>t(T),n=>i(T,n)),p(yt,()=>t(E),n=>i(E,n)),p(xt,()=>t(M),n=>i(M,n)),p($t,()=>t(P),n=>i(P,n)),p(ht,()=>t(z),n=>i(z,n)),p(Et,()=>t(C),n=>i(C,n)),p(Mt,()=>t(N),n=>i(N,n)),p(Nt,()=>t(A),n=>i(A,n)),m(x,u)},$$slots:{default:!0}});var G=r(b,2),$=s(G);et($,{color:"primary",get disabled(){return t(c)},$$events:{click:Lt},children:(x,H)=>{D();var u=j();g(()=>k(u,t(c)?"Guardando...":"Guardar Cambios")),m(x,u)},$$slots:{default:!0}});var ot=r($,2);et(ot,{color:"danger",get disabled(){return t(c)},$$events:{click:qt},children:(x,H)=>{D();var u=j();g(()=>k(u,t(c)?"Eliminando...":"Eliminar Ministerio")),m(x,u)},$$slots:{default:!0}});var Wt=r(ot,2);et(Wt,{color:"secondary",$$events:{click:()=>rt("/ministry-of-justice-in-zaragoza")},children:(x,H)=>{D();var u=j("Cancelar");m(x,u)},$$slots:{default:!0}}),a(G),m(e,d)};At(Gt,e=>{t(c)?e(Ht):e(Yt,!1)})}g(()=>k(St,`Editando ministerio en ${t(o).province??""} (${t(o).year??""})`)),m(_,at),Vt(),Dt()}export{ge as component};
